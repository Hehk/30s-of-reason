{"dependencies":[{"name":"graphql/language/printer","loc":{"line":19,"column":22}},{"name":"apollo-utilities","loc":{"line":20,"column":243}},{"name":"./objectCache","loc":{"line":21,"column":59}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.WriteError=void 0,exports.enhanceErrorWithDocument=i,exports.writeQueryToStore=s,exports.writeResultToStore=c,exports.writeSelectionSetToStore=u;var e=require(\"graphql/language/printer\"),t=require(\"apollo-utilities\"),r=require(\"./objectCache\"),a=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),n=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=\"WriteError\",t}return a(t,e),t}(Error);function i(t,r){var a=new o(\"Error writing result to store for query:\\n \"+(0,e.print)(r));return a.message+=\"\\n\"+t.message,a.stack=t.stack,a}function s(e){var a=e.result,n=e.query,o=e.storeFactory,s=void 0===o?r.defaultNormalizedCacheFactory:o,c=e.store,d=void 0===c?s():c,l=e.variables,f=e.dataIdFromObject,g=e.fragmentMap,p=void 0===g?{}:g,v=e.fragmentMatcherFunction,h=(0,t.getQueryDefinition)(n);l=(0,t.assign)({},(0,t.getDefaultValues)(h),l);try{return u({dataId:\"ROOT_QUERY\",result:a,selectionSet:h.selectionSet,context:{store:d,storeFactory:s,processedData:{},variables:l,dataIdFromObject:f,fragmentMap:p,fragmentMatcherFunction:v}})}catch(e){throw i(e,n)}}function c(e){var a=e.dataId,n=e.result,o=e.document,s=e.storeFactory,c=void 0===s?r.defaultNormalizedCacheFactory:s,d=e.store,l=void 0===d?c():d,f=e.variables,g=e.dataIdFromObject,p=e.fragmentMatcherFunction,v=(0,t.getOperationDefinition)(o),h=v.selectionSet,m=(0,t.createFragmentMap)((0,t.getFragmentDefinitions)(o));f=(0,t.assign)({},(0,t.getDefaultValues)(v),f);try{return u({result:n,dataId:a,selectionSet:h,context:{store:l,storeFactory:c,processedData:{},variables:f,dataIdFromObject:g,fragmentMap:m,fragmentMatcherFunction:p}})}catch(e){throw i(e,o)}}function u(e){var a=e.result,n=e.dataId,o=e.selectionSet,i=e.context,s=i.variables,c=i.store,d=i.fragmentMap;return o.selections.forEach(function(e){var o=(0,t.shouldInclude)(e,s);if((0,t.isField)(e)){var c=(0,t.resultKeyNameFromField)(e),l=a[c];if(o)if(void 0!==l)g({dataId:n,value:l,field:e,context:i});else!(e.directives&&e.directives.length&&e.directives.some(function(e){return e.name&&\"defer\"===e.name.value}))&&i.fragmentMatcherFunction&&((0,t.isProduction)()||console.warn(\"Missing field \"+c+\" in \"+JSON.stringify(a,null,2).substring(0,100)))}else{var f=void 0;if((0,t.isInlineFragment)(e))f=e;else if(!(f=(d||{})[e.name.value]))throw new Error(\"No fragment named \"+e.name.value+\".\");var p=!0;if(i.fragmentMatcherFunction&&f.typeCondition){var v={store:new r.ObjectCache({self:a}),returnPartialData:!1,hasMissingField:!1,cacheResolvers:{}};p=i.fragmentMatcherFunction({type:\"id\",id:\"self\",generated:!1},f.typeCondition.name.value,v),!(0,t.isProduction)()&&v.returnPartialData&&console.error(\"WARNING: heuristic fragment matching going on!\")}o&&p&&u({result:a,selectionSet:f.selectionSet,dataId:n,context:i})}}),c}function d(e){return\"$\"===e[0]}function l(e,r,a){var o=a.get(e),i=a.get(r);Object.keys(o).forEach(function(s){var c=o[s],u=i[s];(0,t.isIdValue)(c)&&d(c.id)&&(0,t.isIdValue)(u)&&l(c.id,u.id,a),a.delete(e),a.set(r,n({},o,i))})}function f(e,t,r){if(!r)return!1;if(r[e]){if(r[e].indexOf(t)>=0)return!0;r[e].push(t)}else r[e]=[t];return!1}function g(r){var a,o,i=r.field,s=r.value,c=r.dataId,g=r.context,v=g.variables,h=g.dataIdFromObject,m=g.store,y=(0,t.storeKeyNameFromField)(i,v),b=!1,F=\"\";if(i.selectionSet&&null!==s)if(Array.isArray(s)){a=p(s,c+\".\"+y,i.selectionSet,g)}else{var I=c+\".\"+y,w=!0;if(d(I)||(I=\"$\"+I),h){var O=h(s);if(O&&d(O))throw new Error('IDs returned by dataIdFromObject cannot begin with the \"$\" character.');O&&(I=O,w=!1)}if(f(I,i,g.processedData)||u({dataId:I,result:s,selectionSet:i.selectionSet,context:g}),a={type:\"id\",id:I,generated:w},(o=m.get(c))&&o[y]!==a){var j=o[y];if((0,t.isIdValue)(a)&&a.generated&&(0,t.isIdValue)(j)&&!j.generated)throw new Error(\"Store error: the application attempted to write an object with no provided id but the store already contains an id of \"+j.id+\" for this object. The selectionSet that was trying to be written is:\\n\"+(0,e.print)(i));(0,t.isIdValue)(j)&&j.generated&&(F=j.id,b=!0)}}else a=null!=s&&\"object\"==typeof s?{type:\"json\",json:s}:s;var S,x=n({},m.get(c),((S={})[y]=a,S));b&&l(F,a.id,m),(o=m.get(c))&&a===o[y]||m.set(c,x)}function p(e,t,r,a){return e.map(function(e,n){if(null===e)return null;var o=t+\".\"+n;if(Array.isArray(e))return p(e,o,r,a);var i=!0;if(a.dataIdFromObject){var s=a.dataIdFromObject(e);s&&(o=s,i=!1)}return f(o,r,a.processedData)||u({dataId:o,result:e,selectionSet:r,context:a}),{type:\"id\",id:o,generated:i}})}exports.WriteError=o;"},"hash":"996ddce416ed86cecefc59da6c567353","cacheData":{"env":{}}}